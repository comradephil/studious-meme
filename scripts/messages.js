/** * @author pb *///globals - track posts on screenvar loadedPosts = 0;var totalPosts = 0;var posts = [];
//use form data to submit to SQL via PHP (AJAX)function submitPost() {	//values from form (but use IDs)	var user = $('#user')[0].value;	var title = $('#title')[0].value;	var post = $('#post')[0].value;	//construct php request	var data = 'user=' + user + '&title=' + title + '&post=' + post;	//blank field check	if (user == '' || title == '' || post == '') {		alert("Please Fill All Fields");	}	//add validation	//not errored - submit post	else {		$.ajax({			type: "POST",			url: "./php/postmessages.php",			data: data,			cache: false,			success: function(html) { alert(html); }		});	}	return true;}
//will retrieve all posts from SQLfunction retrievePosts() {	$.ajax({			type: "POST",			url: "./php/retrievemessages.php",			cache: false,			success: function(html) {parsePosts(html);}		});}
//adding a function to allow a try/catch to add some test datafunction parsePosts(html) {	try {		posts = JSON.parse(html);	}	catch(err) {		posts = [{"CONTENT":"Error","TITLE":"Error","USER":"Phil"},{"CONTENT":"Error","TITLE":"Error","USER":"Phil"},		{"CONTENT":"Error","TITLE":"Error","USER":"Phil"},{"CONTENT":"Error","TITLE":"Error","USER":"Phil"},		{"CONTENT":"Error","TITLE":"Error","USER":"Phil"},{"CONTENT":"Error","TITLE":"Error","USER":"Phil"},		{"CONTENT":"Error","TITLE":"Error","USER":"Phil"},{"CONTENT":"Error","TITLE":"Error","USER":"Phil"}];	}	finally {		totalPosts = posts.length; 		loadPosts(totalPosts);	}
}
//will load new postsfunction loadPosts(numToLoad) {	//trying to load more than there is...	if(totalPosts < numToLoad) {		numToLoad = totalPosts;	}	for(var i = 0; i < numToLoad; i++) {		i = i + loadedPosts;		if(i > totalPosts)			break;		generatePost(i);	}	return;}
function generatePost(postToLoad) {	var board = $('#messageboard')[0];	var div = document.createElement("div");	div.className = "post";	board.appendChild(div);	var h2 = document.createElement("div");	h2.innerHTML = "<b class=\"title\">"+posts[postToLoad].TITLE+"</b> &nbsp; &nbsp; &nbsp; by " + posts[postToLoad].USER + "<br>";	div.appendChild(h2);	var p = document.createElement("p");	p.innerHTML = "<br>" + posts[postToLoad].CONTENT;	div.appendChild(p);}
